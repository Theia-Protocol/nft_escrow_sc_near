# escrow_sc_near
Escrow smart contract on Near network for Theia protocol

# Required Software

- Rust 1.61 + cargo
- Node.js
- NEAR CLI 3.2

# Usage

## Scripts

### Build

#### 1. Build Fungible Token  
```
$ cd ft_token
$ cargo install
$ ./build.sh
$ cd ..
```
Compiles "Fungible Token" smart contract to a WebAssembly binary. The binary path is `./target/wasm32-unknown-unknown/release/ft_token.wasm`.

#### 2. Build Non Fungible Token  
```
$ cd nft_collection
$ cargo install
$ ./build.sh
$ cd ..
```
Compiles "Non Fungible Token" smart contract to a WebAssembly binary. The binary path is `./target/wasm32-unknown-unknown/release/nft_collection.wasm`.

#### 3. Build Proxy Token  
```
$ cd proxy_token
$ cargo install
$ ./build.sh
$ cd ..
```
Compiles "Proxy Token" smart contract to a WebAssembly binary. The binary path is `./target/wasm32-unknown-unknown/release/proxy_token.wasm`.

#### 4. Build Escrow Smart Contract  
```
$ cd nft_escrow
$ cargo install
$ ./build.sh
$ cd ..
```
Compiles "Escrow" smart contract to a WebAssembly binary. The binary path is `./target/wasm32-unknown-unknown/release/nft_escrow_sc.wasm`.

### Test
Integration testing of escrow contract.  
All 13 test features
```
$ cd nft_escrow
$ ./test.sh
```

### Deploy
#### deploy smart contract on mainnet

```
$ cd nft_escrow
$ ./deploy.sh <account-id>
```
Deploys the most recently built WASM binary to `<account-id>` on mainnet, and calls the `new` function with arguments generated by `init-args.js`.

#### deploy smart contract on testnet

```
$ cd nft_escrow
$ dev-deploy.sh [--force]
```

Deploys the most recently built WASM binary to the dev account in `neardev/`, or to a new dev account if `neardev/` is not found or `--force` is set. Calls the `new` function with arguments generated by `init-args.js`.

#### active project
- active ft project  
    Calls `active_ft_project` function with arguments generated by `active-ft-args.js`.

    ```
    $ cd ft_escrow
    $ ./active_ft_project.sh
    ```

- active nft project  
    Calls `active_nft_project` function with arguments generated by `active-nft-args.js`.

    ```
    $ cd nft_escrow
    $ ./active_nft_project.sh
    ```
#### other view functions in [here](./nft_escrow/commands.md)